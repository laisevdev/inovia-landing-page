import { supabase } from '@/integrations/supabase/client';

// Legacy blog posts data
const legacyPosts = [
  {
    id: 1,
    slug: "implementacao-ia-guia-completo",
    title: "Implementação de IA nas Empresas: Guia Completo para 2024",
    description: "Descubra como implementar inteligência artificial na sua empresa de forma estratégica e eficiente, com exemplos práticos e resultados comprovados.",
    date: "2024-01-15",
    readTime: "8 min",
    category: "Inteligência Artificial",
    likes: 24,
    image: "/src/assets/blog-implementacao-ia-guia.jpg",
    content: `# Implementação de IA nas Empresas: Guia Completo para 2024

A inteligência artificial deixou de ser uma tendência futurista para se tornar uma necessidade estratégica. Empresas que ainda não implementaram soluções de IA estão ficando para trás na corrida competitiva.

## Por que Implementar IA Agora?

A implementação de IA pode revolucionar seus processos empresariais de diversas formas:

- **Automação de processos repetitivos**
- **Melhoria na tomada de decisões baseada em dados**
- **Atendimento ao cliente 24/7**
- **Análise preditiva para planejamento estratégico**

## Principais Áreas de Aplicação

### 1. Atendimento ao Cliente
Chatbots inteligentes podem resolver até 80% das consultas básicas, liberando sua equipe para casos mais complexos.

### 2. Análise de Dados
IA pode processar grandes volumes de dados em tempo real, identificando padrões e oportunidades que seriam impossíveis de detectar manualmente.

### 3. Automação de Marketing
Personalização de campanhas, segmentação inteligente de públicos e otimização automática de anúncios.

## Como Começar

1. **Avaliação inicial**: Identifique os processos que mais se beneficiariam da automação
2. **Prova de conceito**: Implemente uma solução piloto em uma área específica
3. **Escalabilidade**: Expanda gradualmente para outras áreas da empresa
4. **Treinamento**: Capacite sua equipe para trabalhar com as novas tecnologias

## Resultados Esperados

Empresas que implementam IA adequadamente relatam:
- Redução de 40% nos custos operacionais
- Aumento de 25% na satisfação do cliente
- Melhoria de 60% na velocidade de tomada de decisões

A IA não é mais uma opção - é uma necessidade competitiva. Comece sua jornada hoje mesmo!`
  },
  {
    id: 2,
    slug: "chatbots-vs-agentes-personalizados",
    title: "Chatbots vs Agentes Personalizados: Qual é a Melhor Opção?",
    description: "Compare as vantagens e desvantagens entre chatbots tradicionais e agentes virtuais personalizados para sua estratégia empresarial.",
    date: "2024-01-10",
    readTime: "6 min",
    category: "Chatbots",
    likes: 18,
    image: "/src/assets/blog-chatbots-vs-agentes-personalizados.jpg",
    content: `# Chatbots vs Agentes Personalizados: Qual é a Melhor Opção?

No mundo do atendimento digital, existe uma grande diferença entre chatbots básicos e agentes virtuais personalizados. Entenda qual opção é ideal para sua empresa.

## Chatbots Tradicionais

### Vantagens:
- **Implementação rápida**: Podem ser configurados em poucos dias
- **Custo inicial baixo**: Soluções prontas no mercado
- **Respostas padronizadas**: Ideais para FAQs básicos

### Desvantagens:
- **Limitações na personalização**
- **Dificuldade com contextos complexos**
- **Experiência genérica para o usuário**

## Agentes Virtuais Personalizados

### Vantagens:
- **Adaptação completa ao seu negócio**
- **Aprendizado contínuo sobre sua empresa**
- **Integração com sistemas internos**
- **Experiência personalizada para cada cliente**

### Desvantagens:
- **Investimento inicial maior**
- **Tempo de desenvolvimento mais longo**
- **Necessidade de treinamento específico**

## Qual Escolher?

A decisão depende dos seus objetivos:

### Escolha Chatbots Tradicionais se:
- Precisa de uma solução rápida
- Tem orçamento limitado
- Seu atendimento é principalmente FAQ
- Não tem integração com sistemas complexos

### Escolha Agentes Personalizados se:
- Quer diferencial competitivo
- Tem processos específicos do negócio
- Valoriza experiência personalizada
- Planeja crescimento a longo prazo

## Nossa Recomendação

Para empresas que buscam crescimento sustentável, agentes personalizados oferecem melhor ROI a longo prazo. O investimento inicial se paga através de:
- Maior satisfação do cliente
- Redução de custos operacionais
- Automação de processos específicos
- Vantagem competitiva

Invista no futuro do seu atendimento!`
  },
  {
    id: 4,
    slug: "roi-agentes-virtuais",
    title: "ROI de Agentes Virtuais: Como Calcular o Retorno do Investimento",
    description: "Aprenda a calcular e maximizar o retorno sobre investimento em agentes virtuais, com métricas práticas e estudos de caso reais.",
    date: "2024-01-05",
    readTime: "10 min",
    category: "Análise de Dados",
    likes: 31,
    image: "/src/assets/blog-roi-agentes-virtuais.jpg",
    content: `# ROI de Agentes Virtuais: Como Calcular o Retorno do Investimento

Investir em agentes virtuais pode parecer custoso inicialmente, mas o retorno sobre investimento (ROI) geralmente supera as expectativas. Vamos analisar como calcular e maximizar esse retorno.

## Fórmula Básica do ROI

**ROI = (Benefícios - Custos) / Custos × 100**

Para agentes virtuais, consideramos:

### Custos:
- Desenvolvimento inicial
- Treinamento e configuração
- Manutenção mensal
- Licenças de software

### Benefícios:
- Redução de custos com atendimento
- Aumento de vendas
- Melhoria na satisfação do cliente
- Disponibilidade 24/7

## Métricas Importantes

### 1. Redução de Custos Operacionais
- **Antes**: 10 atendentes × R$ 3.000/mês = R$ 30.000
- **Depois**: 3 atendentes × R$ 3.000/mês = R$ 9.000
- **Economia mensal**: R$ 21.000

### 2. Aumento na Conversão
- Taxa de conversão anterior: 2%
- Com agente virtual: 3.5%
- Aumento de 75% nas vendas

### 3. Disponibilidade 24/7
- Atendimentos fora do horário comercial: +40%
- Vendas noturnas/fins de semana: +R$ 15.000/mês

## Estudo de Caso Real

**Empresa**: E-commerce de médio porte
**Investimento inicial**: R$ 25.000
**Custos mensais**: R$ 2.000

### Resultados em 12 meses:
- Economia com pessoal: R$ 252.000
- Aumento de vendas: R$ 180.000
- Total de benefícios: R$ 432.000
- Custos totais: R$ 49.000
- **ROI**: 782%

## Como Maximizar o ROI

### 1. Defina Objetivos Claros
- Redução de custos específicos
- Metas de conversão
- KPIs de satisfação

### 2. Integre com Sistemas Existentes
- CRM
- E-commerce
- Sistemas de estoque
- Ferramentas de marketing

### 3. Monitore e Otimize
- Análise mensal de performance
- Ajustes no treinamento
- Expansão gradual de funcionalidades

### 4. Treine Sua Equipe
- Colaboração humano-IA
- Análise de dados
- Otimização contínua

## Tempo de Retorno

Baseado em nossa experiência:
- **Payback médio**: 6-8 meses
- **ROI em 12 meses**: 300-800%
- **ROI em 24 meses**: 500-1200%

## Conclusão

O investimento em agentes virtuais não é apenas sobre tecnologia - é sobre transformação do negócio. Com planejamento adequado e execução estratégica, o ROI pode ser extraordinário.

Está pronto para calcular o ROI do seu projeto?`
  },
  {
    id: 5,
    slug: "automatizacao-processos-erros",
    title: "Automação de Processos: Evitando os 5 Erros Mais Comuns",
    description: "Conheça os principais erros na implementação de automação empresarial e como evitá-los para garantir o sucesso do seu projeto.",
    date: "2024-01-20",
    readTime: "7 min",
    category: "Automação",
    likes: 27,
    image: "/src/assets/blog-automatizacao-processos-erros.jpg",
    content: `# Automação de Processos: Evitando os 5 Erros Mais Comuns

A automação de processos empresariais pode revolucionar sua operação, mas muitas empresas cometem erros que comprometem os resultados. Vamos analisar os 5 erros mais comuns e como evitá-los.

## Erro #1: Começar pela Automação Antes da Otimização

### O Problema:
Automatizar um processo ineficiente apenas torna a ineficiência mais rápida e consistente.

### A Solução:
1. **Mapeie o processo atual completamente**
2. **Identifique gargalos e redundâncias**
3. **Otimize o processo manualmente primeiro**
4. **Só então automatize a versão otimizada**

### Exemplo Prático:
Uma empresa automatizou seu processo de aprovação de pedidos sem otimizá-lo primeiro. Resultado: continuaram com 5 aprovações desnecessárias, só que mais rápidas.

## Erro #2: Não Envolver a Equipe no Processo

### O Problema:
Resistência dos funcionários pode sabotar mesmo a melhor automação.

### A Solução:
- **Comunicação clara sobre benefícios**
- **Treinamento antecipado**
- **Envolvimento na tomada de decisões**
- **Feedback contínuo durante implementação**

### Dica:
Transforme funcionários em "champions" da automação. Pessoas que já usaram e aprovaram se tornam seus melhores embaixadores.

## Erro #3: Tentar Automatizar Tudo de Uma Vez

### O Problema:
Projetos muito ambiciosos têm maior chance de falhar e criar traumas organizacionais.

### A Solução:
**Abordagem Incremental:**
1. Escolha 1-2 processos críticos
2. Implemente e otimize
3. Meça resultados
4. Expanda gradualmente

### Cronograma Sugerido:
- **Mês 1-2**: Análise e planejamento
- **Mês 3-4**: Implementação piloto
- **Mês 5**: Otimização e ajustes
- **Mês 6+**: Expansão para outros processos

## Erro #4: Escolher a Ferramenta Errada

### O Problema:
Ferramenta inadequada pode limitar resultados ou encarecer o projeto.

### Critérios de Seleção:
- **Compatibilidade com sistemas existentes**
- **Escalabilidade**
- **Facilidade de uso**
- **Suporte técnico**
- **Custo total de propriedade**

### Nossa Recomendação:
Sempre faça uma prova de conceito (PoC) antes da implementação completa.

## Erro #5: Não Medir Resultados Adequadamente

### O Problema:
Sem métricas claras, é impossível saber se a automação está funcionando.

### KPIs Essenciais:
- **Tempo médio de processo**
- **Taxa de erro**
- **Satisfação da equipe**
- **Custos operacionais**
- **ROI**

### Dashboard Recomendado:
- Métricas em tempo real
- Comparação antes/depois
- Tendências mensais
- Alertas automáticos

## Como Evitar Esses Erros

### 1. Planejamento Detalhado
- Análise completa dos processos atuais
- Definição clara de objetivos
- Cronograma realista

### 2. Comunicação Transparente
- Regular updates para stakeholders
- Canais abertos para feedback
- Celebração de marcos alcançados

### 3. Suporte Especializado
- Consultoria durante implementação
- Treinamento adequado da equipe
- Suporte técnico contínuo

## Conclusão

A automação bem-sucedida não é sobre tecnologia - é sobre pessoas, processos e planejamento. Evitando esses erros comuns, você aumenta significativamente suas chances de sucesso.

Precisa de ajuda para implementar automação sem erros? Nossa equipe especializada pode guiá-lo em cada etapa!`
  }
];

export const migrateLegacyPosts = async (authorId: string) => {
  try {
    console.log('Iniciando migração dos posts legados...');
    
    for (const legacyPost of legacyPosts) {
      // Check if post already exists
      const { data: existingPost } = await supabase
        .from('blog_posts')
        .select('id')
        .eq('slug', legacyPost.slug)
        .maybeSingle();

      if (existingPost) {
        console.log(`Post ${legacyPost.slug} já existe, pulando...`);
        continue;
      }

      // Create new post with author_id from the start
      const { error } = await supabase
        .from('blog_posts')
        .insert({
          title: legacyPost.title,
          slug: legacyPost.slug,
          description: legacyPost.description,
          content: legacyPost.content,
          featured_image: legacyPost.image,
          category: legacyPost.category,
          status: 'published',
          read_time: legacyPost.readTime,
          likes: legacyPost.likes,
          published_at: new Date(legacyPost.date).toISOString(),
          author_id: authorId, // Set author_id directly to avoid RLS issues
        });

      if (error) {
        console.error(`Erro ao migrar post ${legacyPost.slug}:`, error);
        return { success: false, message: `Erro ao migrar post ${legacyPost.slug}`, error };
      } else {
        console.log(`Post ${legacyPost.slug} migrado com sucesso!`);
      }
    }

    console.log('Migração concluída!');
    return { success: true, message: 'Posts migrados com sucesso!' };
  } catch (error) {
    console.error('Erro na migração:', error);
    return { success: false, message: 'Erro na migração', error };
  }
};